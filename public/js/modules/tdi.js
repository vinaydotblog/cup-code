// Generated by CoffeeScript 1.6.3
/*
	Tab Interface
*/


(function() {
  require(['jquery'], function($) {
    var Tdi, content, first, tabs;
    content = $('#content');
    first = $('#first_document');
    tabs = $('.tabs_wrapper ul');
    Tdi = (function() {
      function Tdi(file) {
        var a, ace_elem, doc;
        this.elem = $('<li>', {
          "class": 'tab'
        });
        a = $('<a>', {
          text: file && file.name || 'untitled'
        });
        this.elem.append(a);
        this.elem.append($('<span>', {
          text: 'x',
          "class": 'close'
        }));
        doc = $('<div>', {
          "class": 'document main'
        });
        content.append(doc);
        ace_elem = $('<div>', {
          css: {
            width: 100,
            height: 100
          }
        }).appendTo(doc);
        editor.add(ace_elem[0]);
        tabs.append(this.elem);
      }

      Tdi.prototype.all = [];

      Tdi.prototype.activate = function() {
        var active_tab, main_document;
        active_tab.removeClass('active');
        active_tab = $(this.elem).addClass('active');
        main_document.hide();
        return main_document = this.doc.show();
      };

      Tdi.prototype.close = function() {
        var active_tab, elem, idx, size;
        elem = $(this.elem).removeClass('active');
        idx = this.all.indexOf(this);
        size = this.all.length;
        this.all.splice(idx, 1);
        this.doc.remove();
        if (size > 1) {
          this.all[size - 2].activate();
        } else {
          active_tab = $();
        }
        elem.removeClass('active');
        elem.addClass('hide').width(0);
        return setTimeout((function() {
          return elem.remove();
        }), 200);
      };

      return Tdi;

    })();
    window.Tdi = Tdi;
    return $.fn.tabbed = function() {
      var active_tab, content_wrapper, tab_wrapper;
      tab_wrapper = this.find('.tabs_wrapper:first');
      content = this.find('.main_content:first');
      tabs = tab_wrapper.find('ul');
      active_tab = $();
      content_wrapper = content;
      tab_wrapper.addClass('tabs');
      tabs.find('li').each(function() {
        return $('<span>', {
          "class": 'close',
          text: 'x'
        }).appendTo(this);
      });
      tabs.on('click', 'li', function() {
        return this.obj.activate();
      });
      tabs.on('click', 'li .close', function(e) {
        e.stopPropagation();
        return this.parentElement.obj.close();
      });
      return tab_wrapper.on('dblclick', function(e) {
        e.stopPropagation();
        return new Tab;
      });
    };
  });

}).call(this);

/*
//@ sourceMappingURL=tdi.map
*/
